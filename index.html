<!DOCTYPE html>
<html>

<head>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta charset="utf-8">
	<title>Homepage</title>
	<link rel="stylesheet" href="index.css">
</head>

<body>
    <p id="demoxd"></p>

	<div class="male">
		<img src="assets/pngaaa.com-1350771.png" alt="male_sign"
			width="200px"
			height="200px">

		<div class="file_upload_male">
			<input type="file" id="upload_male_id" name="fileupload" style="display: none" onChange="Handlechange();"/>
			<input type="hidden" id="filename" readonly="true"/>
			<button type="button" id="fakeBrowse" onclick="handle_browse_click_male();" class="btn btn-success">Upload DNA</button>
		</div>
	</div>
	<div class="female">
		<img src="assets/pngaaa.com-1350791.png" alt="femal_sign"
			width="180px"
			height="200px">

		<div class="file_upload_female">
			<input type="file" id="upload_female_id" name="fileupload" style="display: none" onChange="Handlechange();"/>
			<input type="hidden" id="filename" readonly="true"/>
			<button type="button" id="fakeBrowse" onclick="handle_browse_click_female();" class="btn btn-success">Upload DNA</button>
		</div>
	</div>
	<div class="try_me">
		<button type="button" id="test_btn" onclick="test_on_click();" class="btn btn-danger">Try me!</button>
	</div>
	<div id="db">
		<ul id="list">

		</ul>
	</div>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

        var tmp = {"jaan": 40};
        var new_ = {"as": 2};
        tmp = new_;
        replace_dict(tmp);
        
        document.getElementById("demo2").innerHTML = dict_to_list(mommy);
        // document.getElementById("demo3").innerHTML = same_allele("AT", "TG");
        const child = generate_child(mommy, daddy);
        document.getElementById("demo3").innerHTML = dict_of_dict_to_list(child);
        const child_description = likelihood_and_description(child, gene_description);
        document.getElementById("demo4").innerHTML = child_description["hair"];
        // document.getElementById("demo3").innerHTML = Object.keys(tmp);
    </script>

	<!-- Latest compiled JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

	<script type="module">
        var gene_yes = {};
        // var gene_data_yes = {};
        var gene_description = {};

		//import * as fb_app from "https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js";
		//import * as fb_db from 'https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js';

		import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.2/firebase-app.js";
		import { getDatabase, ref, set, get, child, update, remove } from 'https://www.gstatic.com/firebasejs/9.1.2/firebase-database.js';

		const firebaseConfig = {
			apiKey: "AIzaSyBgxZQgJFrPsV7wFYz5P7uI5heLr0bjTjE",
			authDomain: "propagene.firebaseapp.com",
			databaseURL: "https://propagene-default-rtdb.europe-west1.firebasedatabase.app",
			projectId: "propagene",
			storageBucket: "propagene.appspot.com",
			messagingSenderId: "979940081112",
			appId: "1:979940081112:web:abbc073ff33da252d406ad"
		};
        
		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const db = getDatabase();

		function add_items_to_list(aa,ag,at,cc,cg,ct,gg,gt,tt,description,rsid,topic)
		{
			var ul = document.getElementById("db");
			var header = document.createElement("h1");

			var _aa = document.createElement("divv");
			var _ag = document.createElement("div3");
			var _at = document.createElement("div4");
			var _cc = document.createElement("li");
			var _cg = document.createElement("li");
			var _ct = document.createElement("li");
			var _gg = document.createElement("li");
			var _gt = document.createElement("li");
			var _tt = document.createElement("li");
			var _description = document.createElement("li");
			var _rsid = document.createElement("li");
			var _topic = document.createElement("li");

			header.innerHTML = "Results";

			_aa.innerHTML= "AA: " + aa;
			_ag.innerHTML= "AG: " + ag;
			_at.innerHTML= "AT: " + at;
			_cc.innerHTML= "CC: " + cc;
			_cg.innerHTML= "CG: " + cg;
			_ct.innerHTML= "CT: " + ct;
			_gg.innerHTML= "GG: " + gg;
			_gt.innerHTML= "GT: " + gt;
			_tt.innerHTML= "TT: " + tt;
			_description.innerHTML= "Description: " + description;
			_rsid.innerHTML= "RSID: " + rsid;
			_topic.innerHTML= "Topic: " + topic;

			ul.appendChild(header);
			ul.appendChild(_aa);
			ul.appendChild(_ag);
			ul.appendChild(_at);
			ul.appendChild(_cc);
			ul.appendChild(_cg);
			ul.appendChild(_ct);
			ul.appendChild(_gg);
			ul.appendChild(_gt);
			ul.appendChild(_tt);
			ul.appendChild(_description);
			ul.appendChild(_rsid);
			ul.appendChild(_topic);
		}

		// var lamp = 1;

		// function insert_data()
		// {
		// 	set(ref(db, "Testing/"+lamp.value),
		// 	{
		// 		Name: "Fredy",
		// 		Age: 21
		// 	})
		// 	.then(() =>
		// 	{
		// 		alert("Data stored successfully");
		// 	})
		// 	.catch((error) =>
		// 	{
		// 		alert("Unsuccessfull, error"+error);
		// 	});
		// }

		// insert_data();

        const dbref = ref(db);
        
        var gene_data_yes = {};
        var dong = {"kartul": 24};
        var dog = "mjÃ¤u";
        function get_one_gene_dict(index, dbref)
        {
            get(child(dbref, index.toString())).then((snapshot) =>
            {
                let rsid_gen = snapshot.val().rsid;
                // gene_yes["rsid"] = rsid_gen;
                // console.log(gene_yes["rsid"]);

                let topic_gen = snapshot.val().topic;
                // gene[rsid_gen] = {"alleles": {}, "topic": topic};
                gene_description[snapshot.val().rsid] = {"alleles": {}, "topic": snapshot.val().topic};
                
                dog = "ahhh";
                
                let aa_gen = snapshot.val().AA;
                if (aa_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["AA"] = snapshot.val().AA;
                let ag_gen = snapshot.val().AG;
                if (ag_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["AG"] = snapshot.val().AG;
                let at_gen = snapshot.val().AT;
                if (at_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["AT"] = snapshot.val().AT;
                let cc_gen = snapshot.val().CC;
                if (cc_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["CC"] = snapshot.val().CC;
                let cg_gen = snapshot.val().CG;
                if (cg_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["CG"] = snapshot.val().CG;
                let ct_gen = snapshot.val().CT;
                if (ct_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["CT"] = snapshot.val().CT;
                let gg_gen = snapshot.val().GG;
                if (gg_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["GG"] = snapshot.val().GG;
                let gt_gen = snapshot.val().GT;
                if (gt_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["GT"] = snapshot.val().GT;
                let tt_gen = snapshot.val().TT;
                if (tt_gen !== '') gene_description[snapshot.val().rsid]["alleles"]["TT"] = snapshot.val().TT;
                dong["ok"] = dog;
                // let description_gen = snapshot.val().description;
                // console.log(gene_yes["rsid"]);
                // gene_description[rsid_gen] = gene_data_yes;
                document.getElementById("demoxd").innerHTML = Object.keys(gene_description[Object.keys(gene_description)[0]]["alleles"]);
            })
        }
        // console.log();
        for (let i = 0; i < 20; i++)
        {
            get_one_gene_dict(i, dbref);
            document.getElementById("demoxd").innerHTML = Object.keys(gene_description[Object.keys(gene_description)[5]]["alleles"]);
            
            // document.getElementById("demoxd").innerHTML = Object.keys(dong);
        }
        // document.getElementById("demoxd").innerHTML = Object.keys(gene_description);
        
        function select_data()
        {
            get(child(dbref, "0")).then((snapshot) =>
            {
                let aa_gen = snapshot.val().AA;
                let ag_gen = snapshot.val().AG;
                let at_gen = snapshot.val().AT;
                let cc_gen = snapshot.val().CC;
                let cg_gen = snapshot.val().CG;
                let ct_gen = snapshot.val().CT;
                let gg_gen = snapshot.val().GG;
                let gt_gen = snapshot.val().GT;
                let tt_gen = snapshot.val().TT;
                let description_gen = snapshot.val().description;
                let rsid_gen = snapshot.val().rsid;
                let topic_gen = snapshot.val().topic;

                add_items_to_list(aa_gen,ag_gen,at_gen,cc_gen,cg_gen,
                            ct_gen,gg_gen,gt_gen,tt_gen,description_gen,rsid_gen,topic_gen);
            })
        }

        select_data();
        </script>
	<script src="index.js"></script>
</body>

</html>